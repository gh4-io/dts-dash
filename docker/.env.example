# ============================================================
# DTSD Dashboard — Environment Variables Reference
# ============================================================
#
# Environment variables handle SECRETS and DEPLOYMENT-SPECIFIC values only.
# Application settings (logging, themes, timeline, passwords, cron) live in
# server.config.yml — see server.config.dev.yml for the full reference.
#
# Quick start:
#   Development:  cp docker/.env.dev.example .env.local
#   Production:   cp docker/.env.prod.example .env.prod
#
# ============================================================

# ─── Required ─────────────────────────────────────────────────

# AUTH_SECRET (optional — fallback for auth.secret in server.config.yml)
# Auth.js JWT signing secret. Must be 32+ characters.
# If not set here OR in server.config.yml, one is auto-generated on first run.
# YAML auth.secret takes priority over this env var.
# Generate with: npm run generate-secret
#
# AUTH_SECRET=<generate-with-npm-run-generate-secret>

# ─── Optional ─────────────────────────────────────────────────

# DATABASE_PATH (optional — fallback for database.path in server.config.yml)
# SQLite database file path. Can be absolute or relative to project root.
# YAML database.path takes priority over this env var.
# Default: ./data/dashboard.db
#
# Docker: /app/data/dashboard.db (matches the volume mount)
# Bare metal: ./data/dashboard.db (relative) or /var/lib/dashboard/db (absolute)
#
# DATABASE_PATH=./data/dashboard.db

# NODE_ENV
# Automatically set by Next.js — usually no need to override.
# Values: development | production | test
#
# NODE_ENV=production

# SENTRY_DSN
# Sentry error tracking DSN. Leave empty to disable.
# Get your DSN from: https://sentry.io/settings/projects/
#
# SENTRY_DSN=<https://abc123@o123456.ingest.sentry.io/123456>

# BASE_URL (optional — fallback for app.baseUrl in server.config.yml)
# Public base URL, only needed behind a reverse proxy that rewrites the Host header
# (e.g. Cloudflare Tunnel). Leave unset for auto-detection via trustHost.
# YAML app.baseUrl takes priority over this env var.
#
# BASE_URL=<https://dashboard.example.com>

# ─── Development Only ─────────────────────────────────────────

# INITIAL_ADMIN_EMAIL / INITIAL_ADMIN_PASSWORD
# Auto-create the first admin user during db:seed.
# If unset, seed skips user creation — use /register page instead.
#
# NEVER set these in production. Use /register for the first superadmin.
#
# INITIAL_ADMIN_EMAIL=admin@local
# INITIAL_ADMIN_PASSWORD=admin123

# ─── What is NOT an env var ───────────────────────────────────
#
# These settings live in server.config.yml (not environment variables):
#
#   app.title                    — Site title
#   app.baseUrl                  — Public base URL (for reverse proxy scenarios)
#   auth.secret                  — Auth.js JWT signing secret (auto-generated if missing)
#   database.path                — SQLite database file path
#   logging.level                — Pino log level (trace/debug/info/warn/error)
#   features.enableSeedEndpoint  — Enable /api/seed endpoint
#   features.cronEnabled         — Enable cron scheduler
#   timeline.*                   — Flight board defaults
#   appearance.*                 — Theme and color mode defaults
#   passwordSecurity.*           — Password complexity requirements
#   flights.*                    — Canceled WP visibility and cleanup
#   cron.jobs.*                  — Cron job overrides
#
# Copy server.config.dev.yml -> server.config.yml and edit as needed.
#
# ============================================================
# How .env files work
# ============================================================
#
# LOCAL DEVELOPMENT (npm run dev):
#   Next.js auto-loads .env.local from the project root.
#   No configuration needed — just create the file and start the server.
#
# DOCKER (docker compose up):
#   The compose env_file directive reads the file from the HOST and injects
#   key-value pairs as environment variables into the container.
#   The file itself is NOT mounted — only its values are passed.
#   .dockerignore excludes all .env* files from the image build.
#
# BARE METAL / PM2 / SYSTEMD:
#   Source the file manually or use EnvironmentFile= in the service unit.
#
# ============================================================
# Security Checklist
# ============================================================
#
# [x] AUTH_SECRET is unique per environment and 32+ characters
# [x] .env.local / .env.prod are in .gitignore (never committed)
# [x] Default passwords changed after first login
# [x] INITIAL_ADMIN_* unset in production
# [x] features.enableSeedEndpoint: false in server.config.yml (production)
# [x] logging.level: info or warn in server.config.yml (production)
# [x] Database backups scheduled (see BACKUP.md)
#
# ============================================================
# Troubleshooting
# ============================================================
#
# "AUTH_SECRET is not set"
#   → Normally auto-generated on first run (saved to server.config.yml)
#   → Or set auth.secret in server.config.yml / AUTH_SECRET in .env.local
#
# "AUTH_SECRET must be at least 32 characters"
#   → Generate a new secret with: npm run generate-secret
#
# "Database locked"
#   → Stop all running instances
#   → Delete .db-shm and .db-wal files in data/
#
# "Cannot login after reset"
#   → Clear browser cookies or use incognito mode
#
# ============================================================
