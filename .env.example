# ============================================================
# CVG Line Maintenance Dashboard — Environment Variables
# ============================================================
# Template for environment configuration.
# Copy to .env.local and fill in the values:
#   cp .env.example .env.local
# ============================================================

# ─── Authentication (REQUIRED) ──────────────────────────────

# [REQUIRED] Auth.js session signing secret
# Must be 32+ characters. Generate with:
#   npm run generate-secret
#
# ⚠️  CRITICAL: Use a unique secret for each environment
# ⚠️  Never commit this value to version control
AUTH_SECRET=

# ─── Database ───────────────────────────────────────────────

# SQLite database file path
# Can be absolute or relative to project root
# Default: ./data/dashboard.db
#
# Examples:
#   DATABASE_PATH=./data/dashboard.db          (relative)
#   DATABASE_PATH=/var/lib/dashboard/db        (absolute)
#   DATABASE_PATH=/app/data/dashboard.db       (Docker)
#
# DATABASE_PATH=./data/dashboard.db

# ─── First-Run Setup ────────────────────────────────────────

# Initial admin credentials for automatic seeding
# If not set, seed will skip user creation and you must use /setup
#
# Development example:
#   INITIAL_ADMIN_EMAIL=admin@cvg.local
#   INITIAL_ADMIN_PASSWORD=admin123
#
# Production: Leave empty and use /setup page for first admin
#
# INITIAL_ADMIN_EMAIL=
# INITIAL_ADMIN_PASSWORD=

# ─── Application Settings ───────────────────────────────────

# Node environment
# Values: development | production | test
# Automatically set by Next.js — usually no need to override
# NODE_ENV=production

# Enable the /api/seed endpoint for programmatic seeding
# Default: false (disabled)
#
# Development: Can enable for testing
# Production: Requires superadmin auth even if enabled
#
# ENABLE_SEED_ENDPOINT=false

# ─── Password Security (Optional Fallback) ──────────────────

# These variables are FALLBACK defaults when server.config.yml
# doesn't specify password requirements.
#
# Best Practice: Configure via server.config.yml (tracked in git)
# Use these env vars ONLY for deployment-specific overrides
#
# Minimum password length (8-128 characters)
# Default: 12
# PASSWORD_MIN_LENGTH=12

# Maximum password length (8-128 characters)
# Default: 128
# PASSWORD_MAX_LENGTH=128

# Require uppercase letters (true/false)
# Default: true
# PASSWORD_REQUIRE_UPPERCASE=true

# Require lowercase letters (true/false)
# Default: true
# PASSWORD_REQUIRE_LOWERCASE=true

# Require digits (true/false)
# Default: true
# PASSWORD_REQUIRE_DIGITS=true

# Require special characters (true/false)
# Default: true
# PASSWORD_REQUIRE_SPECIAL_CHARS=true

# Prevent common passwords from blocklist (true/false)
# Default: true
# PASSWORD_PREVENT_COMMON=true

# Minimum entropy score (0-100)
# 0 = disabled, 30-50 = medium, 70+ = high security
# Default: 50
# PASSWORD_MIN_ENTROPY=50

# ─── Cron / Scheduled Tasks ────────────────────────────────

# Enable/disable in-app scheduled tasks
# Schedule and grace period are stored in the database (cron_jobs table)
# Default: true
#
# CRON_ENABLED=true

# ─── Logging ────────────────────────────────────────────────

# Log level for server-side pino logger
# Values: trace | debug | info | warn | error | fatal
# Default: debug (dev) | info (production)
#
# Development: Use 'debug' for verbose output
# Production: Use 'info' or 'warn'
#
# LOG_LEVEL=info

# ─── Error Tracking (Optional) ──────────────────────────────

# Sentry DSN for error tracking
# Leave empty to disable error tracking
# Get your DSN from: https://sentry.io/settings/projects/
#
# Example:
#   SENTRY_DSN=https://abc123@o123456.ingest.sentry.io/123456
#
# SENTRY_DSN=

# ─── Docker-Specific ────────────────────────────────────────

# When running in Docker, use these values:
#
#   NODE_ENV=production
#   DATABASE_PATH=/app/data/dashboard.db
#   AUTH_SECRET=<generate-with-npm-run-generate-secret>
#   LOG_LEVEL=info
#
# Mount ./data as volume for persistence:
#   volumes:
#     - ./data:/app/data

# ============================================================
# Quick Start Guide
# ============================================================
#
# 1. Copy this file:
#    cp .env.example .env.local
#
# 2. Generate AUTH_SECRET:
#    npm run generate-secret
#    (copy output to AUTH_SECRET above)
#
# 3. Set initial admin credentials (dev only):
#    INITIAL_ADMIN_EMAIL=admin@cvg.local
#    INITIAL_ADMIN_PASSWORD=admin123
#
# 4. Initialize database:
#    npm run db:reset -- --seed
#
# 5. Start the application:
#    npm run dev               (development)
#    npm run build && npm start (production)
#    docker compose up -d       (Docker)
#
# 6. Login:
#    http://localhost:3000/login
#    Use credentials from step 3 or /setup page
#
# ============================================================
# Security Checklist
# ============================================================
#
# ✅ AUTH_SECRET is unique and 32+ characters
# ✅ .env.local is in .gitignore (never commit)
# ✅ Default passwords changed after first login
# ✅ INITIAL_ADMIN_* unset or empty in production
# ✅ ENABLE_SEED_ENDPOINT=false in production
# ✅ LOG_LEVEL=info or warn in production
# ✅ Database backups scheduled (see BACKUP.md)
#
# ============================================================
# Troubleshooting
# ============================================================
#
# Issue: "AUTH_SECRET is not set"
# Fix: Run `npm run generate-secret` and set AUTH_SECRET
#
# Issue: "AUTH_SECRET must be at least 32 characters"
# Fix: Generate a new secret with `npm run generate-secret`
#
# Issue: Database locked
# Fix: Stop all running instances, delete .db-shm and .db-wal
#
# Issue: Cannot login after reset
# Fix: Clear browser cookies or use incognito mode
#
# ============================================================
